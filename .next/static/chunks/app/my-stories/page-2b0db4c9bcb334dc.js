(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2269],{5749:(e,t,s)=>{Promise.resolve().then(s.bind(s,8426))},6948:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>l,aR:()=>n,wL:()=>h});var r=s(5155),a=s(2115),i=s(4269);let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});l.displayName="Card";let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...a})});n.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent";let h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...a})});h.displayName="CardFooter"},7037:(e,t,s)=>{"use strict";s.d(t,{F:()=>n});var r=s(5155),a=s(2115),i=s(9034),l=s(4269);let n=a.forwardRef((e,t)=>{let{className:s,children:a,viewportRef:n,...c}=e;return(0,r.jsxs)(i.bL,{ref:t,className:(0,l.cn)("relative overflow-hidden",s),...c,children:[(0,r.jsx)(i.LM,{ref:n,className:"h-full w-full rounded-[inherit]",children:a}),(0,r.jsx)(o,{}),(0,r.jsx)(i.OK,{})]})});n.displayName=i.bL.displayName;let o=a.forwardRef((e,t)=>{let{className:s,orientation:a="vertical",...n}=e;return(0,r.jsx)(i.VM,{ref:t,orientation:a,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...n,children:(0,r.jsx)(i.lr,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=i.VM.displayName},8426:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Z});var r=s(5155),a=s(2115),i=s(6633),l=s(6072),n=s(3998),o=s(6948),c=s(5142),d=s(7037),h=s(6766),u=s(6826),x=s(6651),m=s(5299),p=s(1360),j=s(6046),f=s(949),b=s(651),v=s(7048),g=s(4615),y=s(3829),w=s(9926),N=s(1715),C=s(4813),k=s(586),A=s(6860),I=s(6685),S=s(5894),$=s(4585),E=s(9708),_=s(3683),D=s(243),L=s(6259),T=s(6767);let R=[{id:"example-story-1",title:"The Last Signal",content:"<h3>Logline</h3><p>In a future where humanity lives in underground bunkers, a lone radio operator picks up a mysterious signal from the surface, forcing her to choose between the safety of her home and the dangerous truth above.</p><br/><h3>Characters</h3><ul><li><b>ANYA (20s):</b> A sharp, curious radio operator, born and raised in Bunker 7.</li><li><b>COMMANDER VALERIUS (50s):</b> The rigid, protective leader of the bunker.</li></ul><br/><h3>Scene 1</h3><p><b>INT. RADIO ROOM - NIGHT</b></p><p>Anya sits amidst a sea of humming analog equipment. Static crackles. Suddenly, a faint, rhythmic beep cuts through. Not a distress call. Something else. Something... structured.</p>",authorId:"system",createdAt:new Date(Date.now()-2592e5),updatedAt:new Date(Date.now()-1728e5)},{id:"example-story-2",title:"Emerald City Blues",content:"<h3>Logline</h3><p>A down-on-his-luck private investigator in a rain-soaked, neon-lit Seattle gets more than he bargained for when a simple missing person case unravels a conspiracy involving a tech giant and a mythical artifact.</p><br/><h3>Characters</h3><ul><li><b>JAKE (40s):</b> A cynical but brilliant P.I. with a troubled past.</li><li><b>CHLOE (30s):</b> The enigmatic client who hires him.</li></ul>",authorId:"system",createdAt:new Date(Date.now()-432e6),updatedAt:new Date(Date.now()-864e5)},{id:"example-story-3",title:"Untitled Romantic Comedy",content:"<h3>Logline</h3><p>Two rival bookstore owners in a charming small town must join forces to save their businesses from a corporate chain, only to find they might be writing their own love story in the process.</p>",authorId:"system",createdAt:new Date(Date.now()-864e6),updatedAt:new Date(Date.now()-864e6)}];function Z(){let{user:e}=(0,i.A)(),{toast:t}=(0,S.dj)(),[s,Z]=(0,a.useState)([]),[M,z]=(0,a.useState)([]),[H,P]=(0,a.useState)(null),[O,B]=(0,a.useState)(""),[U,F]=(0,a.useState)(""),[J,G]=(0,a.useState)(!0),[V,Y]=(0,a.useState)(!1),[q,K]=(0,a.useState)(!1),[W,Q]=(0,a.useState)(""),X=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(!e){G(!1),Z(R),R.length>0&&P(R[0]);return}G(!0);let s=(0,E.P)((0,E.rJ)($.db,"stories"),(0,E._M)("authorId","==",e.uid),(0,E.My)("updatedAt","desc")),r=(0,E.aQ)(s,e=>{let t=e.docs.map(e=>({...e.data(),id:e.id}));e.empty?(Z(R),R.length>0&&P(R[0])):(Z(t),H&&t.find(e=>e.id===H.id)||P(t[0]||null)),G(!1)},e=>{console.error("Error fetching stories:",e),t({title:"Error",description:"Could not fetch stories.",variant:"destructive"}),G(!1)});return()=>r()},[e,t,H]),(0,a.useEffect)(()=>{z(s.filter(e=>e.title.toLowerCase().includes(W.toLowerCase())))},[W,s]),(0,a.useEffect)(()=>{if(H){B(H.title);let e=H.content||"";F(e),X.current&&(X.current.innerHTML=e)}else B(""),F(""),X.current&&(X.current.innerHTML="")},[H]);let ee=()=>{P(null),B("Untitled Story"),F(""),X.current&&(X.current.innerHTML="",X.current.focus())},et=async()=>{var s;if(!e||H&&"system"===H.authorId)return void t({title:"Cannot Save Example",description:"Please create a new story to save your work.",variant:"destructive"});if(!O.trim())return void t({title:"Error",description:"Title is required to save a story.",variant:"destructive"});Y(!0);let r=(null==(s=X.current)?void 0:s.innerHTML)||U;try{if(H&&"system"!==H.authorId){let e=(0,E.H9)($.db,"stories",H.id);await (0,E.mZ)(e,{title:O,content:r,updatedAt:(0,E.O5)()}),t({title:"Success",description:"Story updated successfully."})}else{let s=(0,E.rJ)($.db,"stories"),a=(0,E.O5)(),i={id:(await (0,E.gS)(s,{title:O,content:r,authorId:e.uid,createdAt:a,updatedAt:a})).id,title:O,content:r,authorId:e.uid,createdAt:{toDate:()=>new Date},updatedAt:{toDate:()=>new Date}};P(i),t({title:"Success",description:"Story saved successfully."})}}catch(e){console.error("Error saving story:",e),t({title:"Error",description:"Could not save the story.",variant:"destructive"})}finally{Y(!1)}},es=async()=>{if(!H||!e||H.authorId!==e.uid)return void t({title:"Error",description:"You can't delete this story.",variant:"destructive"});if(window.confirm('Are you sure you want to delete "'.concat(H.title,'"?'))){K(!0);try{await (0,E.kd)((0,E.H9)($.db,"stories",H.id)),t({title:"Success",description:"Story deleted."}),P(null)}catch(e){console.error("Error deleting story:",e),t({title:"Error",description:"Could not delete the story.",variant:"destructive"})}finally{K(!1)}}},er=(e,t)=>{X.current&&(X.current.focus(),document.execCommand(e,!1,t),F(X.current.innerHTML))};return(0,r.jsx)(l.AppLayout,{children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[380px_1fr] h-screen",children:[(0,r.jsxs)("aside",{className:"col-span-1 border-r border-border flex flex-col",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-border flex items-center justify-between",children:[(0,r.jsxs)("h1",{className:"text-xl font-bold flex items-center gap-2",children:[(0,r.jsx)(h.A,{})," My Stories"]}),(0,r.jsx)(T.Bc,{children:(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{variant:"ghost",size:"icon",onClick:ee,children:(0,r.jsx)(u.A,{className:"h-5 w-5"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"New Story"})})]})})]}),(0,r.jsx)("div",{className:"p-4 border-b border-border",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(x.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(c.p,{placeholder:"Search stories...",className:"pl-9",value:W,onChange:e=>Q(e.target.value)})]})}),(0,r.jsx)(d.F,{className:"flex-1",children:J?(0,r.jsxs)("div",{className:"p-4 space-y-2",children:[(0,r.jsx)(D.E,{className:"h-16 w-full"}),(0,r.jsx)(D.E,{className:"h-16 w-full"}),(0,r.jsx)(D.E,{className:"h-16 w-full"})]}):M.length>0?M.map(e=>{var t;return(0,r.jsxs)("div",{className:"p-4 border-b border-border cursor-pointer hover:bg-accent ".concat((null==H?void 0:H.id)===e.id?"bg-accent":""),onClick:()=>{P(e)},children:[(0,r.jsx)("h3",{className:"font-semibold truncate",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground truncate",dangerouslySetInnerHTML:{__html:(null==(t=e.content)?void 0:t.replace(/<[^>]+>/g,""))||"No content yet..."}}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.updatedAt&&(e.updatedAt.toDate?(0,_.GP)(e.updatedAt.toDate(),"PPp"):(0,_.GP)(e.updatedAt,"PPp"))})]},e.id)}):(0,r.jsxs)("div",{className:"text-center text-muted-foreground p-8",children:[(0,r.jsx)("p",{children:s.length>0?"No stories match your search.":"You haven't written any stories yet."}),0===s.length&&(0,r.jsx)(n.$,{variant:"link",onClick:ee,children:"Create your first story"})]})})]}),(0,r.jsxs)("main",{className:"col-span-1 flex flex-col h-screen bg-secondary/20",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-border bg-background flex items-center justify-between gap-4",children:[(0,r.jsx)(c.p,{placeholder:"Story Title",className:"text-lg font-semibold border-0 focus-visible:ring-0 ring-offset-0 p-0 h-auto bg-transparent",value:O,onChange:e=>B(e.target.value)}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[H&&H.authorId===(null==e?void 0:e.uid)&&(0,r.jsx)(T.Bc,{children:(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{variant:"destructive",size:"icon",onClick:es,disabled:q,children:q?(0,r.jsx)(m.A,{className:"animate-spin"}):(0,r.jsx)(p.A,{})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Delete Story"})})]})}),(0,r.jsxs)(n.$,{onClick:et,disabled:V||!!H&&"system"===H.authorId,children:[V?(0,r.jsx)(m.A,{className:"mr-2 animate-spin"}):(0,r.jsx)(j.A,{className:"mr-2"}),"Save Story"]})]})]}),(0,r.jsx)("div",{className:"flex-1 flex flex-col",children:(0,r.jsxs)(o.Zp,{className:"m-4 flex-1 flex flex-col rounded-md overflow-hidden",children:[(0,r.jsx)(T.Bc,{children:(0,r.jsxs)("div",{className:"p-2 border-b border-border bg-background flex items-center gap-1 flex-wrap",children:[(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>er("undo"),children:(0,r.jsx)(f.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Undo"})})]}),(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>er("redo"),children:(0,r.jsx)(b.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Redo"})})]}),(0,r.jsx)(L.w,{orientation:"vertical",className:"h-6 mx-1"}),(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>er("bold"),children:(0,r.jsx)(v.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Bold"})})]}),(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>er("italic"),children:(0,r.jsx)(g.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Italic"})})]}),(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>er("underline"),children:(0,r.jsx)(y.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Underline"})})]}),(0,r.jsx)(L.w,{orientation:"vertical",className:"h-6 mx-1"}),(0,r.jsxs)("div",{className:"relative h-8 w-8",children:[(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{let e=document.getElementById("color-picker-input");null==e||e.click()},children:(0,r.jsx)(w.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Text Color"})})]}),(0,r.jsx)("input",{id:"color-picker-input",type:"color",className:"absolute top-0 left-0 w-full h-full opacity-0 cursor-pointer",onChange:e=>er("foreColor",e.target.value)})]}),(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,r.jsx)(N.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Paragraph"})})]}),(0,r.jsx)(L.w,{orientation:"vertical",className:"h-6 mx-1"}),(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>er("justifyLeft"),children:(0,r.jsx)(C.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Align Left"})})]}),(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>er("justifyCenter"),children:(0,r.jsx)(k.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Align Center"})})]}),(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>er("justifyRight"),children:(0,r.jsx)(A.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Align Right"})})]}),(0,r.jsxs)(T.m_,{children:[(0,r.jsx)(T.k$,{asChild:!0,children:(0,r.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>er("justifyFull"),children:(0,r.jsx)(I.A,{className:"h-4 w-4"})})}),(0,r.jsx)(T.ZI,{children:(0,r.jsx)("p",{children:"Justify"})})]})]})}),(0,r.jsx)("div",{ref:X,contentEditable:!0,className:"flex-1 w-full h-full resize-none border-0 focus-visible:ring-0 ring-offset-0 p-4 text-base bg-background focus:outline-none overflow-y-auto",onInput:e=>F(e.currentTarget.innerHTML),suppressContentEditableWarning:!0})]})})]})]})})}}},e=>{e.O(0,[9135,3965,5031,6900,2494,988,6434,9034,1296,6072,8441,1255,7358],()=>e(e.s=5749)),_N_E=e.O()}]);