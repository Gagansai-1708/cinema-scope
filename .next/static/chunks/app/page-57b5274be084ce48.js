(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{9298:(e,s,t)=>{Promise.resolve().then(t.bind(t,9547))},9547:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>_});var r=t(5155),a=t(5239),o=t(6072),i=t(1335),n=t(6948),l=t(5897),c=t(3998),d=t(7772),m=t(3457),h=t(5937),u=t(9652),p=t(235),x=t(7181),j=t(2115),f=t(4585),v=t(9708),g=t(3298),b=t(243),k=t(6633),w=t(5894),N=t(4269),y=t(9041),E=t(6767);function C(){return(0,r.jsxs)("div",{className:"flex gap-4 p-4",children:[(0,r.jsx)(b.E,{className:"h-10 w-10 rounded-full"}),(0,r.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(b.E,{className:"h-5 w-24"}),(0,r.jsx)(b.E,{className:"h-4 w-32"})]}),(0,r.jsx)(b.E,{className:"h-4 w-full"}),(0,r.jsx)(b.E,{className:"h-4 w-3/4"}),(0,r.jsx)("div",{className:"relative aspect-[16/9] rounded-lg overflow-hidden border border-border",children:(0,r.jsx)(b.E,{className:"h-full w-full"})}),(0,r.jsxs)("div",{className:"flex justify-around pt-2",children:[(0,r.jsx)(b.E,{className:"h-8 w-16"}),(0,r.jsx)(b.E,{className:"h-8 w-16"}),(0,r.jsx)(b.E,{className:"h-8 w-16"}),(0,r.jsx)(b.E,{className:"h-8 w-8"})]})]})]})}let S=[{id:"mock-1",author:{name:"CinemaScope Staff",username:"cinemascope",avatarUrl:"https://picsum.photos/seed/cinemascope/200/200",uid:"cinemascope_staff_uid"},timestamp:v.Dc.fromMillis(Date.now()-72e5),content:"Welcome to CinemaScope! This is a sample post to show you how things look. You can share your thoughts on movies, post reviews, or discuss the latest industry news.",imageUrl:"https://picsum.photos/seed/welcome/1200/675",imageHint:"cinema seats",likes:15,comments:2,retweets:1},{id:"mock-2",author:{name:"Jane Doe",username:"janedoe",avatarUrl:"https://picsum.photos/seed/janedoe/200/200",uid:"jane_doe_uid"},timestamp:v.Dc.fromMillis(Date.now()-864e5),content:'Just watched the new "Dune: Part Two" trailer. The scale is absolutely epic! Denis Villeneuve is a master of visual storytelling. What does everyone else think? #Dune #SciFi',videoUrl:"https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",likes:256,comments:42,retweets:58},{id:"mock-3",author:{name:"A24",username:"A24",avatarUrl:"https://pbs.twimg.com/profile_images/1473431189494210561/hQp0S3b5_400x400.jpg",uid:"a24_uid"},timestamp:v.Dc.fromMillis(Date.now()-2592e5),content:"From the mind of Ari Aster. BEAU IS AFRAID starring Joaquin Phoenix is now playing everywhere.",imageUrl:"https://picsum.photos/seed/beau/1200/675",imageHint:"movie still",likes:1200,comments:150,retweets:300}];function _(){let{user:e}=(0,k.A)(),{toast:s}=(0,w.dj)(),[t,b]=(0,j.useState)([]),[_,A]=(0,j.useState)(!0),[D,I]=(0,j.useState)(null),[U,P]=(0,j.useState)(new Set),[$,B]=(0,j.useState)(new Set),[Z,z]=(0,j.useState)({});(0,j.useEffect)(()=>{let e=(0,v.P)((0,v.rJ)(f.db,"posts"),(0,v.My)("timestamp","desc")),s=(0,v.aQ)(e,e=>{e.empty?b(S):b(e.docs.map(e=>({id:e.id,...e.data()}))),A(!1)},e=>{console.error("Error fetching posts: ",e),console.log("Using sample data due to Firestore connection issue"),b(S),A(!1)});return()=>s()},[s]),(0,j.useEffect)(()=>{if(!e)return;let s=(0,v.rJ)(f.db,"users",e.uid,"bookmarks"),t=(0,v.P)(s,(0,v._M)("type","==","post")),r=(0,v.aQ)(t,e=>{let s={};e.forEach(e=>{s[e.data().originalPostId]=e.id}),z(s)},e=>{console.error("Error fetching bookmarks:",e)});return()=>r()},[e]);let J=async(t,r,a,o)=>{if(t.id.startsWith("mock-"))return void s({title:"Demo Post",description:"Interactions are disabled for sample posts."});if("comment"===r)return void I(t);if(a&&o){let i=a.has(t.id);if(!e){let e=new Set(a);i?e.delete(t.id):e.add(t.id),o(e);return}let n=(0,v.H9)(f.db,"posts",t.id);try{await (0,v.mZ)(n,{["like"===r?"likes":"retweets"]:(0,v.GV)(i?-1:1)});let e=new Set(a);i?e.delete(t.id):e.add(t.id),o(e)}catch(e){console.error("Error ".concat(i?"un":"").concat(r,"ing post:"),e),s({title:"Error",description:"Could not update post. It might not exist in the database.",variant:"destructive"})}}},H=async t=>{if(t.id.startsWith("mock-"))return void s({title:"Demo Post",description:"Interactions are disabled for sample posts."});if(!e)return void s({title:"Sign in to bookmark",description:"Create an account to save posts to your bookmarks.",variant:"default"});let r=Z[t.id];if(r)try{await (0,v.kd)((0,v.H9)(f.db,"users",e.uid,"bookmarks",r)),s({title:"Post Removed from Bookmarks",description:"It has been removed from your collection."})}catch(e){console.error("Error removing bookmark:",e),s({title:"Error",description:"Could not remove the post from your bookmarks.",variant:"destructive"})}else try{let r=(0,v.rJ)(f.db,"users",e.uid,"bookmarks"),a={name:t.author.name,username:t.author.username,avatarUrl:t.author.avatarUrl||""};await (0,v.gS)(r,{type:"post",originalPostId:t.id,author:a,content:t.content,timestamp:(0,g.m)(t.timestamp.toDate())+" ago",bookmarkedAt:v.Dc.now()}),s({title:"Post Bookmarked!",description:"It has been added to your collection."})}catch(e){console.error("Error bookmarking post:",e),s({title:"Error",description:"Could not bookmark the post.",variant:"destructive"})}};return(0,r.jsxs)(o.AppLayout,{rightSidebar:(0,r.jsx)(i.J,{}),children:[D&&(0,r.jsx)(y._,{isOpen:!!D,setIsOpen:e=>!e&&I(null),post:D}),(0,r.jsx)("div",{className:"sticky top-0 z-20 border-b border-border bg-background/80 backdrop-blur-md",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h1",{className:"text-xl font-bold",children:"Home"}),!e&&(0,r.jsx)("div",{className:"mt-2 p-3 bg-purple-500/10 border border-purple-500/30 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-purple-300",children:["You're browsing as a guest. ",(0,r.jsx)("button",{onClick:()=>window.location.href="/signup",className:"underline hover:text-purple-200",children:"Sign up"})," for full access to bookmark posts and more features."]})})]})}),(0,r.jsx)("div",{className:"border-t border-border",children:_?Array.from({length:3}).map((e,s)=>(0,r.jsx)(C,{},s)):t.length>0?t.map(e=>{let t=U.has(e.id),o=$.has(e.id),i=!!Z[e.id];return(0,r.jsx)(n.Zp,{className:"border-x-0 border-b border-t-0 rounded-none hover:bg-accent/50 transition-colors",children:(0,r.jsxs)("div",{className:"flex gap-4 p-4",children:[(0,r.jsxs)(l.eu,{children:[(0,r.jsx)(l.BK,{src:e.author.avatarUrl,alt:e.author.name}),(0,r.jsx)(l.q5,{children:e.author.name.charAt(0)})]}),(0,r.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,r.jsx)("p",{className:"font-semibold hover:underline cursor-pointer",children:e.author.name}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["@",e.author.username," \xb7 ",e.timestamp?(0,g.m)(e.timestamp.toDate())+" ago":"just now"]})]}),(0,r.jsx)(E.Bc,{children:(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(c.$,{variant:"ghost",size:"icon",className:"w-8 h-8 -mr-2 -mt-2",children:(0,r.jsx)(d.A,{className:"h-5 w-5"})})}),(0,r.jsx)(E.ZI,{children:(0,r.jsx)("p",{children:"More"})})]})})]}),(0,r.jsx)("p",{className:"whitespace-pre-wrap py-2",children:e.content}),(0,r.jsxs)(n.Wu,{className:"p-0 pt-3",children:[e.imageUrl&&(0,r.jsx)("div",{className:"relative aspect-video rounded-lg overflow-hidden border border-border",children:(0,r.jsx)(a.default,{src:e.imageUrl,alt:"Post image",fill:!0,className:"object-cover","data-ai-hint":e.imageHint})}),e.videoUrl&&(0,r.jsx)("div",{className:"relative aspect-video rounded-lg overflow-hidden border border-border mt-2",children:(0,r.jsx)("video",{src:e.videoUrl,controls:!0,className:"w-full h-full object-contain bg-black"})})]}),(0,r.jsx)(n.wL,{className:"p-0 pt-3 flex justify-around -ml-2",children:(0,r.jsxs)(E.Bc,{children:[(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsxs)(c.$,{variant:"ghost",size:"sm",className:(0,N.cn)("flex items-center gap-2 text-muted-foreground hover:text-red-500",t&&"text-red-500"),onClick:()=>J(e,"like",U,P),children:[(0,r.jsx)(m.A,{className:(0,N.cn)("h-5 w-5",t&&"fill-current")}),(0,r.jsx)("span",{className:"text-xs",children:e.likes})]})}),(0,r.jsx)(E.ZI,{children:(0,r.jsx)("p",{children:"Like"})})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsxs)(c.$,{variant:"ghost",size:"sm",className:"flex items-center gap-2 text-muted-foreground hover:text-primary",onClick:()=>J(e,"comment"),children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"text-xs",children:e.comments})]})}),(0,r.jsx)(E.ZI,{children:(0,r.jsx)("p",{children:"Comment"})})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsxs)(c.$,{variant:"ghost",size:"sm",className:(0,N.cn)("flex items-center gap-2 text-muted-foreground hover:text-green-500",o&&"text-green-500"),onClick:()=>J(e,"retweet",$,B),children:[(0,r.jsx)(u.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"text-xs",children:e.retweets})]})}),(0,r.jsx)(E.ZI,{children:(0,r.jsx)("p",{children:"Retweet"})})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(c.$,{variant:"ghost",size:"sm",className:(0,N.cn)("flex items-center gap-2 text-muted-foreground hover:text-primary",i&&"text-primary"),onClick:()=>H(e),children:(0,r.jsx)(p.A,{className:(0,N.cn)("h-5 w-5",i&&"fill-current")})})}),(0,r.jsx)(E.ZI,{children:(0,r.jsx)("p",{children:"Bookmark"})})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(c.$,{variant:"ghost",size:"sm",className:"flex items-center gap-2 text-muted-foreground hover:text-primary",onClick:()=>{var t;return t=e.id,void(navigator.clipboard.writeText("".concat(window.location.origin,"/post/").concat(t)),s({title:"Link Copied!",description:"The post link has been copied to your clipboard."}))},children:(0,r.jsx)(x.A,{className:"h-5 w-5"})})}),(0,r.jsx)(E.ZI,{children:(0,r.jsx)("p",{children:"Share"})})]})]})})]})]})},e.id)}):(0,r.jsx)("div",{className:"text-center p-8 text-muted-foreground",children:"No posts yet. Be the first to post!"})})]})}}},e=>{e.O(0,[9135,3965,5031,6900,2494,988,2619,6434,3298,6072,8200,8441,1255,7358],()=>e(e.s=9298)),_N_E=e.O()}]);